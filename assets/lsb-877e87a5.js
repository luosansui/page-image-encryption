import{c as a}from"./index-0e062450.js";import d from"./mersenne-twister-7ec0138d.js";import{utf8Encode as p,utf8Decode as m}from"./utf_8-ea3fe091.js";import"./index-7a388a79.js";import"./zip-4713de7c.js";function h(r,o){const n=Array.from(Array(o).keys()),f=[];let s;const e=a.SHA512(r).words.reduce(function(l,u){return l+Math.abs(u)},0),t=new d(e);for(let l=o;l>0;l--)s=t.genrand_int32()%l,f.push(n[s]),n[s]=n[l-1];return f}function b(r,o){const n=p(r),f=[],s=n.length;for(let e=0;e<s;e++)for(let t=128;t>0;t=Math.floor(t/2))if(Math.floor(n[e]/t)){for(let l=0;l<o;l++)f.push(1);n[e]-=t}else for(let l=0;l<o;l++)f.push(0);for(let e=0;e<24;e++)for(let t=0;t<o;t++)f.push(1);return f}function g(r,o){function n(l){const u=l.length;let i=0;for(let c=0;c<u;c++)i+=l[c];return Math.round(i/u)}const f=[];let s,e;const t=Math.floor(Math.floor(r.length/o)/8);for(let l=0;l<t;l++){s=0,e=128;for(let u=0;u<8;u++)s+=n(r.slice((l*8+u)*o,(l*8+u+1)*o))*e,e=Math.floor(e/2);if(s==255)break;f.push(s)}return m(f)}function _(r,o,n){const f=r.length;if(r.length>n)throw"Can not hold this many data!";const s=Array(n);for(let t=0;t<n;t++)s[t]=Math.floor(Math.random()*2);const e=h(o,n);for(let t=0;t<f;t++)s[e[t]]=r[t];return s}function w(r,o){function n(t){return t%2==1?t-1:t}function f(t){return t%2==1?t:t+1}let s=0;const e=new Uint8ClampedArray(r.length);for(let t=0;t<e.length;t+=4)e[t]=o[s]?f(r[t]):n(r[t]),e[t+1]=o[s+1]?f(r[t+1]):n(r[t+1]),e[t+2]=o[s+2]?f(r[t+2]):n(r[t+2]),e[t+3]=r[t+3],s+=3;return e.buffer}function M(r,o){const n=r.length,f=Array(n),s=h(o,n);for(let e=0;e<n;e++)f[e]=r[s[e]];return f}function y(r){const o=[];for(let n=0;n<r.length;n+=4)o.push(r[n]%2==1?1:0),o.push(r[n+1]%2==1?1:0),o.push(r[n+2]%2==1?1:0);return o}function E(r,o,n=1){const f=new Uint8ClampedArray(r.buffer),s=y(f),e=M(s,o);return g(e,n)}const T=(r,o,n,f=1)=>{const s=new Uint8ClampedArray(r.buffer);let e=r.buffer;const t=s.length/4*3;let l=b(o,f);return l=_(l,n,t),e=w(s,l),{width:r.width,height:r.height,name:r.name,buffer:e}};export{E as readMsgFromImage,T as writeMsgToImage};
